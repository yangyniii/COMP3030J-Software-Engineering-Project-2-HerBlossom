<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href="../static/img/favicon.ico" type="image/x-icon">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../static/assets/bootstrap/css/bootstrap.min.css">
    <!-- icon css_test-->
    <link rel="stylesheet" href="../static/assets/elagent-icon/style.css">
    <link rel="stylesheet" href="../static/assets/animation/animate.css">
    <link rel="stylesheet" href="../static/css_test/style.css">
    <link rel="stylesheet" href="../static/css_test/responsive.css">
    <title>HerBlossom</title>
</head>

<body data-scroll-animation="true">
    <div id="preloader">
        <div id="ctn-preloader" class="ctn-preloader">
            <div class="round_spinner">
                <div class="spinner"></div>
                <div class="text">
                    <img src="../static/img/spinner_logo.png" alt="">
                    <h4><span>HerBlossom</span></h4>
                </div>
            </div>
            <h2 class="head">Did You Know?</h2>
            <p></p>
        </div>
    </div>

    <div class="body_wrapper">
        <nav class="navbar navbar-expand-lg menu_one" id="sticky">
            <div class="container">
                <a class="navbar-brand sticky_logo" href="/index">
                    <img src="../static/img/logo.png" srcset="../static/img/logo-w.png 2x" alt="logo">
                </a>
                <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="menu_toggle">
                        <span class="hamburger">
                            <span></span>
                            <span></span>
                            <span></span>
                        </span>
                        <span class="hamburger-cross">
                            <span></span>
                            <span></span>
                        </span>
                    </span>
                </button>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav menu ml-auto">
                        <li class="nav-item dropdown submenu">
                            <a href="/index" class="nav-link dropdown-toggle" role="button" data-toggle="dropdown"
                               aria-haspopup="true" aria-expanded="false">Home</a>
                            <i class="arrow_carrot-down_alt2 mobile_dropdown_icon" aria-hidden="true"
                               data-toggle="dropdown"></i>
                            <!--?                            <ul class="dropdown-menu">-->
                            <!--?                               <li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>-->
                            <!--?                            </ul>-->
                        </li>
                        <li class="nav-item dropdown submenu mega_menu tab-demo">
                            <a href="/forum-topics" class="nav-link dropdown-toggle" role="button"
                               data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Forum</a>
                            <i class="arrow_carrot-down_alt2 mobile_dropdown_icon" aria-hidden="true"
                               data-toggle="dropdown"></i>
                        </li>
                        <li class="nav-item dropdown submenu mega_menu tab-demo">
                            <a href="/blog" class="nav-link dropdown-toggle" role="button" data-toggle="dropdown"
                               aria-haspopup="true" aria-expanded="false">Blog</a>
                        </li>
                        <li class="nav-item dropdown submenu mega_menu tab-demo">
                            <a href="#" class="nav-link dropdown-toggle" role="button" data-toggle="dropdown"
                               aria-haspopup="true" aria-expanded="false">Job Recommendation</a>
                        </li>
                        <li class="nav-item dropdown submenu">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Products
                            </a>
                            <i class="arrow_carrot-down_alt2 mobile_dropdown_icon" aria-hidden="false" data-toggle="dropdown"></i>
                            <ul class="dropdown-menu dropdown_menu_two">
                                <li class="nav-item">
                                    <a href="contact.html" class="nav-link">
                                        <img src="../static/img/tick.png" alt="">
                                        <div class="text">
                                            <h5>Content Us</h5>
                                            <p>Send your feedback here!</p>
                                        </div>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="aboutus.html" class="nav-link">
                                        <img src="../static/img/sheet.png" alt="">
                                        <div class="text">
                                            <h5>About Us</h5>
                                            <p>Want to know more about<br>QUEENs NEVER CRY?</p>
                                        </div>
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <a class="nav_btn" href="signin.html">Sign In</a>
                </div>
            </div>
        </nav>

        <section class="breadcrumb_area">
            <img class="p_absolute bl_left" src="../static/img/v.svg" alt="">
            <img class="p_absolute bl_right" src="../static/img/home_one/b_leaf.svg" alt="">
            <img class="p_absolute star" src="../static/img/home_one/banner_bg.png" alt="">
            <img class="p_absolute wave_shap_one" src="../static/img/blog-classic/shap_01.png" alt="">
            <img class="p_absolute wave_shap_two" src="../static/img/blog-classic/shap_02.png" alt="">
            <img class="p_absolute one wow fadeInRight" src="../static/img/home_one/girl_img.png" alt="">
            <img class="p_absolute two wow fadeInUp" data-wow-delay="0.2s" src="../static/img/home_one/flower.png" alt="">
            <div class="container">
                <form action="/job-recommendation" method="GET" class="banner_search_form">
                    <div class="input-group">
                        <input type="search" name="keyword" class="form-control" placeholder="Search any job here"
                               value="{{ keyword if keyword else '' }}">
                        <div class="input-group-append">
                            <button type="submit" class="btn btn-primary">
                                <i class="icon_search"></i> 搜索
                            </button>
                        </div>
                    </div>
                </form>
            </div>

        </section>
        <section class="page_breadcrumb">
            <div class="container">
                <div class="row">
                    <div class="col-sm-7">
                        <nav aria-label="breadcrumb">
                          <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="/index">Home</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Job</li>
                          </ol>
                        </nav>
                    </div>
                    <div class="col-sm-5">
                        <a href="#" class="date"><i class="icon_clock_alt"></i>Updated on {{ featured_job.publish_date if featured_job else 'April 03, 2025' }}</a>
                    </div>
                </div>
            </div>
        </section>

       <!-- job-recommendation.html 的内容继续 -->
<section class="job_filter_section py-4 bg-light">
    <div class="container">
        <div class="d-flex flex-wrap gap-3">
            <div class="filter-tag position-relative">
                <button class="btn btn-outline-secondary" data-toggle="tooltip" title="距離最近、距離最遠">Location</button>
            </div>
            <div class="filter-tag position-relative">
                <button class="btn btn-outline-secondary" data-toggle="tooltip" title="如：Python工程師、數據分析等">Title</button>
            </div>
            <div class="filter-tag position-relative">
                <button class="btn btn-outline-secondary" data-toggle="tooltip" title="按時薪排序">Salary</button>
            </div>
            <div class="filter-tag position-relative">
                <button class="btn btn-outline-secondary" data-toggle="tooltip" title="不限、本科、碩士等">Education</button>
            </div>
            <div class="filter-tag position-relative">
                <button class="btn btn-outline-secondary" data-toggle="tooltip" title="更多選項">Tags</button>
            </div>
        </div>
    </div>
</section>

<!-- 主体内容 -->
<section class="job_listings_section py-4">
    <div class="container d-flex flex-row gap-4">
        <!-- 左侧职位概览 -->
        <div class="left_panel border p-3 bg-white shadow-sm rounded-3" style="width: 40%; height: 1000px; overflow-y: auto; min-width: 400px;">
            {% if job_list|length == 0 %}
                <p class="text-muted text-center py-4">暂无职位信息</p>
            {% else %}
                {% for job in job_list %}
                <div class="job_summary border rounded-3 p-3 mb-3 bg-light shadow-sm hover-shadow transition-all"
                     onclick="showJobDetail('{{ job.job_id }}')"
                     style="cursor: pointer; transition: all 0.3s ease;">
                    <div class="d-flex justify-content-between align-items-start">
                        <h5 class="mb-3">{{ job.title }}</h5>
                        <span class="badge bg-success">{{ job.salary }}</span>
                    </div>
                    <div class="job-meta text-muted mb-2">
                        <small>
                            <i class="fas fa-map-marker-alt"></i> 📍 {{ job.location }} |
                            <i class="fas fa-briefcase"></i> 🧰 {{ job.experience }} |
                            <i class="fas fa-graduation-cap"></i> 🎓 {{ job.education }}
                        </small>
                    </div>
                    <p class="mb-2">{{ job.short_desc }}</p>
                    <div class="job-tags mt-3">
                        {% for tag in job.tags.split(',') %}
                            <span class="badge bg-light text-dark border me-2">{{ tag.strip() }}</span>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
            {% endif %}
        </div>

        <!-- 右侧详细信息 -->
        <div class="right_panel border p-4 bg-white shadow-sm rounded-3 flex-fill"
             style="width: 60%; height: 1000px; overflow-y: auto; min-width: 600px;">
            {% if job_list|length == 0 %}
            <div class="text-center py-5">
                <i class="fas fa-info-circle fa-3x text-muted mb-3"></i>
                <p class="text-muted">Please select a position on the left to view details.</p>
            </div>
            {% else %}
            {% for job in job_list %}
            <div id="{{ job.job_id }}" class="job_detail {% if not loop.first %}d-none{% endif %}">
                <div class="job-header border-bottom pb-3 mb-4">
                    <h4 class="mb-3">{{ job.title }}</h4>
                    <div class="job-meta d-flex flex-wrap gap-3">
                        <div class="meta-item">
                            <i class="fas fa-map-marker-alt text-danger"></i>
                            <strong>Location：</strong>{{ job.location }}
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-briefcase text-warning"></i>
                            <strong>Experience：</strong>{{ job.experience }}
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-graduation-cap text-info"></i>
                            <strong>Education：</strong>{{ job.education }}
                        </div>
                    </div>
                    <div class="job-tags mt-3">
                        {% for tag in job.tags.split(',') %}
                        <span class="badge bg-light text-dark border me-2">{{ tag.strip() }}</span>
                        {% endfor %}
                    </div>
                </div>
                <div class="job-description">
                    <h5 class="mb-3">Description:</h5>
                    <ul class="list-unstyled">
                        {% for line in job.full_desc.split('\n') %}
                        <li class="mb-2">
                            <i class="fas fa-check-circle text-success me-2"></i>
                            {{ line }}
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>
</section>

        <style>
            .hover-shadow:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
            }

            .transition-all {
                transition: all 0.3s ease;
            }

            .job-meta .meta-item {
                background: #f8f9fa;
                padding: 0.5rem 1rem;
                border-radius: 20px;
                font-size: 0.9rem;
            }

            .job-description li {
                padding: 0.5rem 0;
                border-bottom: 1px dashed #eee;
            }

            .job-description li:last-child {
                border-bottom: none;
            }

        </style>

        <!-- Back to top button -->
        <a id="back-to-top" title="Back to Top"></a>

        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js_test, then Bootstrap JS -->
        <script src="../static/js_test/jquery-3.2.1.min.js"></script>
        <script src="../static/js_test/pre-loader.js"></script>
        <script src="../static/assets/bootstrap/js/popper.min.js"></script>
        <script src="../static/assets/bootstrap/js/bootstrap.min.js"></script>
        <script src="../static/js_test/parallaxie.js"></script>
        <script src="../static/js_test/TweenMax.min.js"></script>
        <script src="../static/js_test/jquery.wavify.js"></script>
        <script src="../static/assets/wow/wow.min.js"></script>
        <script src="../static/js_test/main.js"></script>
        <script>
            $(function () {
                $('[data-toggle="tooltip"]').tooltip();
            });

            // 展示职位详情
            function showJobDetail(id) {
                document.querySelectorAll('.job_detail').forEach(el => {
                    el.classList.add('d-none');
                });
                document.getElementById(id).classList.remove('d-none');
            }

            $(document).ready(function () {
                // 搜索按钮点击事件
                $('#search_button').click(function () {
                    var keyword = $('#search_keyword').val();
                    searchJobs(keyword);
                });

                // 当用户按下回车键时触发搜索
                $('#search_keyword').keypress(function (e) {
                    if (e.which == 13) {
                        var keyword = $('#search_keyword').val();
                        searchJobs(keyword);
                    }
                });

                // 搜索职位函数
                function searchJobs(keyword) {
                    $.ajax({
                        url: '/search_jobs',  // 后端处理搜索请求的接口
                        method: 'GET',
                        data: {keyword: keyword},  // 传递搜索关键字
                        success: function (response) {
                            if (response.jobs && response.jobs.length > 0) {
                                updateJobList(response.jobs);  // 更新职位列表
                            } else {
                                $('#job_list').html('<p class="text-muted text-center py-4">没有找到相关职位</p>');
                            }
                        },
                        error: function (error) {
                            console.error('搜索失败:', error);
                        }
                    });
                }

                // 更新职位列表
                function updateJobList(jobs) {
                    console.log('接收到的职位数据:', jobs);  // 调试输出
                    var jobHtml = '';
                    jobs.forEach(function (job) {
                        jobHtml += `
                            <div class="job_summary border rounded-3 p-3 mb-3 bg-light shadow-sm hover-shadow transition-all"
                                 onclick="showJobDetail('${job.job_id}')" style="cursor: pointer;">
                                <div class="d-flex justify-content-between align-items-start">
                                    <h5 class="mb-3">${job.title}</h5>
                                    <span class="badge bg-success">${job.salary}</span>
                                </div>
                                <div class="job-meta text-muted mb-2">
                                    <small>
                                        <i class="fas fa-map-marker-alt"></i> 📍 ${job.location} |
                                        <i class="fas fa-briefcase"></i> 🧰 ${job.experience} |
                                        <i class="fas fa-graduation-cap"></i> 🎓 ${job.education}
                                    </small>
                                </div>
                                <p class="mb-2">${job.short_desc}</p>
                                <div class="job-tags mt-3">
                                    ${job.tags.split(',').map(tag => `<span class="badge bg-light text-dark border me-2">${tag.trim()}</span>`
                    ).
                        join('')
                    }
                </div>
                </div>
                    `;
                    });
                    $('#job_list').html(jobHtml);  // 更新职位列表
                }
            });
        </script>